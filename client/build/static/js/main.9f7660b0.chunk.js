(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{18:function(e,t,s){},40:function(e,t,s){},65:function(e,t,s){"use strict";s.r(t);var n=s(1),a=s.n(n),c=s(34),r=s.n(c),i=(s(40),s(16)),o=s(5),l=s(6),u=s(8),h=s(7),d=s(14),j=s(2),p=s.n(j),b=function(e,t,s){return p.a.post("/api/auth/signup",{username:e,password:t,email:s}).then((function(e){return e.data})).catch((function(e){return e.response.data}))},m=function(e,t){return p.a.post("/api/auth/login",{username:e,password:t}).then((function(e){return e.data})).catch((function(e){return e.response.data}))},g=s(0),O=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(){var e;Object(o.a)(this,s);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={username:"",password:"",email:""},e.handleFormSubmit=function(t){console.log(t),t.preventDefault();var s=e.state,n=s.username,a=s.password,c=s.email;b(n,a,c).then((function(t){t.errorMessage?e.setState({message:t.errorMessage,username:"",password:"",email:""}):(e.props.setUser(t),e.props.history.push("/"))}))},e.handleChange=function(t){var s=t.target,n=s.name,a=s.value;e.setState(Object(d.a)({},n,a))},e}return Object(l.a)(s,[{key:"render",value:function(){var e=this;return Object(g.jsx)("div",{children:Object(g.jsxs)("form",{onSubmit:this.handleFormSubmit,children:[Object(g.jsxs)("label",{children:["Username:",Object(g.jsx)("input",{type:"text",name:"username",value:this.state.username,onChange:function(t){return e.handleChange(t)}})]}),Object(g.jsxs)("label",{children:["Password:",Object(g.jsx)("input",{name:"password",value:this.state.password,onChange:function(t){return e.handleChange(t)}})]}),Object(g.jsxs)("label",{children:["Email:",Object(g.jsx)("input",{name:"email",value:this.state.email,onChange:function(t){return e.handleChange(t)}})]}),Object(g.jsx)("input",{type:"submit",value:"Signup"}),this.state.message&&Object(g.jsx)("h4",{children:this.state.message})]})})}}]),s}(n.Component),f=(s(32),function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(){var e;Object(o.a)(this,s);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={username:"",password:""},e.handleFormSubmit=function(t){t.preventDefault();var s=e.state,n=s.username,a=s.password;m(n,a).then((function(t){t.message?e.setState({message:t.message,username:"",password:""}):(e.props.setUser(t),e.props.history.push("/"))}))},e.handleChange=function(t){var s=t.target,n=s.name,a=s.value;e.setState(Object(d.a)({},n,a))},e}return Object(l.a)(s,[{key:"render",value:function(){var e=this;return Object(g.jsx)("div",{children:Object(g.jsxs)("form",{onSubmit:this.handleFormSubmit,children:[Object(g.jsxs)("label",{className:"form-label",children:["Username:",Object(g.jsx)("input",{className:"form-control",type:"text",name:"username",value:this.state.username,onChange:function(t){return e.handleChange(t)}})]}),Object(g.jsxs)("label",{className:"form-label",children:["Password:",Object(g.jsx)("input",{className:"form-control",type:"password",name:"password",value:this.state.password,onChange:function(t){return e.handleChange(t)}})]}),Object(g.jsx)("input",{type:"submit",value:"Login"}),this.state.message&&Object(g.jsx)("h4",{children:this.state.message})]})})}}]),s}(n.Component)),v=s(4),x=s(15),y=s(3),k=(s(18),function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).getPosts=n.getPosts.bind(Object(x.a)(n)),n.state={posts:[]},n}return Object(l.a)(s,[{key:"getPosts",value:function(){var e=this;p.a.get("/api/posts/allPosts").then((function(t){e.setState({posts:t.data})})).catch((function(e){console.log(e)}))}},{key:"componentDidMount",value:function(){this.getPosts()}},{key:"render",value:function(){var e=this.props;return e.user?0===this.state.posts.length?Object(g.jsx)("h3",{children:" Loading... "}):Object(g.jsx)("div",{className:"wall",children:this.state.posts.slice(0).reverse().map((function(t){return Object(g.jsx)("div",{className:"post",style:{width:"18rem"},children:Object(g.jsxs)("div",{className:"card-body",children:[e.user._id===t.postedBy._id?Object(g.jsx)(y.b,{to:"/userprofile",children:Object(g.jsxs)("h5",{className:"card-title",children:[" ",t.postedBy.username]})}):Object(g.jsx)(y.b,{to:"/otheruser/".concat(t.postedBy._id),children:Object(g.jsxs)("h5",{className:"card-title",children:[" ",t.postedBy.username]})}),Object(g.jsx)(y.b,{to:"/allPosts/".concat(t._id),children:Object(g.jsx)("img",{src:t.imgURL,className:"card-img-top",alt:"..."})}),Object(g.jsx)("p",{className:"card-text",children:t.description}),Object(g.jsx)("div",{children:t.comments.slice(-1).map((function(e){return Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:e.postedBy.username}),e.comment]},e._id)}))})]})},t._id)}))}):Object(g.jsxs)("div",{className:"btn-toolbar justify-content-center",children:[Object(g.jsx)(y.b,{className:"btn btn-success  btn-sm",to:"/signup",children:"Signup"}),Object(g.jsx)(y.b,{className:"btn btn-dark  btn-sm",to:"/login",children:"Login"})]})}}]),s}(a.a.Component)),C=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(){return Object(o.a)(this,s),t.apply(this,arguments)}return Object(l.a)(s,[{key:"render",value:function(){return Object(g.jsx)("nav",{className:"navbar navbar-expand-md navbar-light navBg",children:Object(g.jsx)(y.b,{className:"navbar-brand",to:"/",children:" Instagram  "})})}}]),s}(a.a.Component),P=p.a.create({baseURL:"/api",withCredentials:!0}),U=function(e){throw e},N={service:P,handleUpload:function(e){return P.post("/posts/upload",e).then((function(e){return e.data})).catch(U)},createPost:function(e){return P.post("/posts/postIt",e).then((function(e){return e.data})).catch(U)},handleUploadPicture:function(e){return P.post("/profiles/uploadpicture",e).then((function(e){return e.data})).catch(U)},createPicture:function(e){return P.post("/profiles/picture",e).then((function(e){return e.data})).catch(U)}},w=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).getUserImage=function(e){var t="",s=new FormData;console.log(e.target.files[0]),s.append("imgURL",e.target.files[0]),N.handleUploadPicture(s).then((function(e){t=e.secure_url})).catch((function(e){console.log("Error while adding the thing: ",e)})).finally((function(){p.a.post("/api/profiles/picture",{imgURL:t}).then((function(e){console.log(e),n.setState({imgURL:e.data.imgURL})})).catch((function(e){console.log("Error while adding the thing: ",e)}))}))},n.handleLogout=n.handleLogout.bind(Object(x.a)(n)),n.state={imgURL:n.props.user.imgURL},n}return Object(l.a)(s,[{key:"handleLogout",value:function(){var e=this;p.a.post("/api/auth/logout").then((function(e){return e.data})).catch((function(e){return e.response.data})).then((function(){e.props.setUser(null)}))}},{key:"render",value:function(){var e=this;return Object(g.jsxs)("nav",{className:"navbar navbar-expand-md navbar-light navBg",style:{backgroundColor:"pink"},children:[Object(g.jsxs)(y.b,{className:"navbar-brand",to:"/",children:[" ","Instagram"," "]}),Object(g.jsx)("div",{className:"collapse navbar-collapse justify-content-end",id:"navbarCollapse",children:Object(g.jsxs)("div",{className:"navbar-nav",children:[Object(g.jsx)("div",{children:Object(g.jsxs)("form",{className:"userImgForm",children:[Object(g.jsx)("label",{htmlFor:"file-input",children:Object(g.jsx)("img",{alt:"imageuser",style:{width:"30px"},src:this.state.imgURL})}),Object(g.jsx)("input",{id:"file-input",type:"file",onChange:this.getUserImage})]})}),Object(g.jsx)(y.b,{className:"nav-item nav-link active",to:"/",onClick:function(){return e.handleLogout(e.props)},children:"Logout"}),Object(g.jsxs)(y.b,{className:"nav-item nav-link",to:"/userprofile",children:[this.props.user.username,"'s Profile"]}),Object(g.jsxs)(y.b,{className:"nav-item nav-link",to:"/creatpost",children:[" ",Object(g.jsx)("img",{className:"addButton",src:"/img/add-button-pngrepo-com.png",alt:"add"})]})]})})]})}}]),s}(a.a.Component);var S=function(e){return e.user?Object(g.jsx)(w,{user:e.user,setUser:e.setUser}):Object(g.jsx)(C,{})},L=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).getPosts=n.getPosts.bind(Object(x.a)(n)),n.state={posts:[],imgURL:"",isFileUpoading:!1},n}return Object(l.a)(s,[{key:"getPosts",value:function(){var e=this;p.a.get("/api/posts/userPosts").then((function(t){e.setState({posts:t.data})})).catch((function(e){console.log(e)}))}},{key:"componentDidMount",value:function(){this.getPosts()}},{key:"render",value:function(){return 0===this.state.posts.length?Object(g.jsx)("h3",{children:" Loading... "}):Object(g.jsx)("div",{className:"wall",children:this.state.posts.slice(0).reverse().map((function(e){return Object(g.jsx)("div",{className:"post",style:{width:"18rem"},children:Object(g.jsxs)("div",{className:"card-body",children:[Object(g.jsxs)("h5",{className:"card-title",children:[" ",e.postedBy.username]}),Object(g.jsx)(y.b,{to:"/allPosts/".concat(e._id),children:Object(g.jsx)("img",{src:e.imgURL,className:"card-img-top",alt:"..."})}),Object(g.jsx)("p",{className:"card-text",children:e.description})]})},e._id)}))})}}]),s}(a.a.Component),_=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(){var e;Object(o.a)(this,s);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={message:"",description:"",imgURL:"",isFileUpoading:!1},e.handleChange=function(t){var s=t.target,n=s.name,a=s.value;e.setState(Object(d.a)({},n,a))},e.handleFileUpload=function(t){t.preventDefault(),e.setState({isFileUpoading:!0}),console.log("The file to be uploaded is: ",t.target.files[0]);var s=new FormData;s.append("imgURL",t.target.files[0]),N.handleUpload(s).then((function(t){console.log("response is: ",t),e.setState({imgURL:t.secure_url})})).catch((function(e){console.log("Error while uploading the file: ",e)})).finally((function(){e.setState({isFileUpoading:!1})}))},e.handleSubmit=function(t){t.preventDefault(),N.createPost(e.state).then((function(t){console.log("added: ",t),e.props.history.push("/userprofile")})).catch((function(t){e.setState({message:"Please make something pretty"}),console.log("Error while adding the thing: ",t)}))},e}return Object(l.a)(s,[{key:"render",value:function(){var e=this;return console.log("this is the state",this.state),console.log(this.state),Object(g.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(g.jsxs)("label",{children:["Description:",Object(g.jsx)("input",{value:this.state.description,name:"description",onChange:this.handleChange})]}),Object(g.jsx)("label",{children:" Img: "}),Object(g.jsx)("input",{type:"file",onChange:function(t){return e.handleFileUpload(t)}}),Object(g.jsx)("button",{disabled:this.state.isFileUpoading,type:"submit",children:"Post"}),this.state.message&&Object(g.jsx)("h4",{children:this.state.message})]})}}]),s}(a.a.Component),D=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).handleChange=function(e){var t=e.target,s=t.name,a=t.value;n.setState(Object(d.a)({},s,a))},n.handlePostDelete=function(){var e=n.props.match.params.id;p.a.delete("/api/posts/allPosts/".concat(e)).then(n.props.history.push("/")).catch((function(e){console.log(e)}))},n.handleCommentDelete=function(e){e.preventDefault();var t=n.props.match.params.id,s=e.target.value;p.a.post("/api/posts/allPosts/".concat(t,"/uncomment"),{commentId:s}).then((function(e){n.setState({post:e.data})})).catch((function(e){console.log(e)}))},n.handleSubmit=function(e){var t=n.props.match.params.id;e.preventDefault(),n.state.comment&&p.a.post("/api/posts/allPosts/".concat(t,"/comment"),{comment:n.state.comment}).then((function(e){n.setState({comment:"",post:e.data})})).catch((function(e){console.log(e)}))},n.likePost=function(e){var t=n.props.match.params.id;e.preventDefault(),p.a.post("/api/posts/allPosts/".concat(t,"/like"),{like:n.state.like}).then((function(e){n.setState({post:e.data})})).catch((function(e){console.log(e)}))},n.unlikePost=function(e){var t=n.props.match.params.id;e.preventDefault(),p.a.post("/api/posts/allPosts/".concat(t,"/unlike"),{like:n.state.like}).then((function(e){n.setState({post:e.data})})).catch((function(e){console.log(e)}))},n.getPost=n.getPost.bind(Object(x.a)(n)),n.state={post:null,comment:"",like:""},n}return Object(l.a)(s,[{key:"getPost",value:function(){var e=this,t=this.props.match.params.id;p.a.get("/api/posts/allPosts/".concat(t)).then((function(t){e.setState({post:t.data})})).catch((function(e){console.log(e)}))}},{key:"componentDidMount",value:function(){this.getPost()}},{key:"render",value:function(){var e=this;if(null===this.state.post)return Object(g.jsx)("h3",{children:" Loading... "});var t=this.state.post;return Object(g.jsxs)("div",{className:"post",style:{width:"18rem"},children:[Object(g.jsxs)("div",{className:"card-body",children:[this.props.user._id===t.postedBy._id?Object(g.jsx)(y.b,{to:"/userprofile",children:Object(g.jsxs)("h5",{className:"card-title",children:[" ",t.postedBy.username]})}):Object(g.jsx)(y.b,{to:"/otheruser/".concat(t.postedBy._id),children:Object(g.jsxs)("h5",{className:"card-title",children:[" ",t.postedBy.username]})}),Object(g.jsx)("img",{src:t.imgURL,className:"card-img-top",alt:"..."}),Object(g.jsx)("p",{className:"card-text",children:t.description})]}),Object(g.jsxs)("div",{children:[t.likes.includes(this.props.user._id)?Object(g.jsx)("button",{onClick:this.unlikePost,children:" Unlike "}):Object(g.jsx)("button",{onClick:this.likePost,children:" Like "}),t.likes.length]}),this.props.user._id===this.state.post.postedBy._id?Object(g.jsx)("div",{children:Object(g.jsx)("button",{onClick:this.handlePostDelete,children:"Delete"})}):"",Object(g.jsxs)("div",{children:[Object(g.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(g.jsxs)("label",{children:["Comment:",Object(g.jsx)("input",{value:this.state.comment,name:"comment",onChange:this.handleChange})]}),Object(g.jsx)("div",{}),Object(g.jsx)("button",{type:"submit",children:"Comment"})]}),Object(g.jsx)("div",{children:this.state.post.comments.slice(0).reverse().map((function(t){return Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:t.postedBy.username}),t.comment,e.props.user._id===t.postedBy._id?Object(g.jsx)("button",{value:t._id,onClick:e.handleCommentDelete,children:"Delete"}):""]},t._id)}))})]})]},t._id)}}]),s}(a.a.Component),B=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).state={posts:[]},n}return Object(l.a)(s,[{key:"getPosts",value:function(){var e=this;console.log(this.props.match.params.id);var t=this.props.match.params.id;p.a.get("/api/profiles/".concat(t)).then((function(t){console.log(t),e.setState({posts:t.data})})).catch((function(e){console.log(e)}))}},{key:"componentDidMount",value:function(){this.getPosts()}},{key:"render",value:function(){return 0===this.state.posts.length?Object(g.jsx)("h3",{children:" Loading... "}):Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{children:"aaaaaa"}),this.state.posts.slice(0).reverse().map((function(e){return Object(g.jsx)("div",{className:"post",style:{width:"18rem"},children:Object(g.jsxs)("div",{className:"card-body",children:[Object(g.jsxs)("h5",{className:"card-title",children:[" ",e.postedBy.username]}),Object(g.jsx)(y.b,{to:"/allPosts/".concat(e._id),children:Object(g.jsx)("img",{src:e.imgURL,className:"card-img-top",alt:"..."})}),Object(g.jsx)("p",{className:"card-text",children:e.description})]})},e._id)}))]})}}]),s}(a.a.Component),F=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(){var e;Object(o.a)(this,s);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={user:e.props.user},e.setUser=function(t){e.setState({user:t})},e}return Object(l.a)(s,[{key:"render",value:function(){var e=this;return Object(g.jsxs)("div",{className:"App",children:[Object(g.jsx)(S,{user:this.state.user,setUser:this.setUser}),Object(g.jsxs)(v.d,{children:[Object(g.jsx)(v.b,{exact:!0,path:"/signup",render:function(t){return Object(g.jsx)(O,Object(i.a)({setUser:e.setUser},t))}}),Object(g.jsx)(v.b,{exact:!0,path:"/login",render:function(t){return Object(g.jsx)(f,Object(i.a)({setUser:e.setUser},t))}}),Object(g.jsx)(v.b,{exact:!0,path:"/",render:function(t){return Object(g.jsx)(k,Object(i.a)({user:e.state.user},t))}}),Object(g.jsx)(v.b,{exact:!0,path:"/allPosts/:id",render:function(t){return Object(g.jsx)(D,Object(i.a)({user:e.state.user},t))}}),Object(g.jsx)(v.b,{exact:!0,path:"/userprofile",render:function(t){return e.state.user?Object(g.jsx)(L,Object(i.a)({user:e.state.user},t)):Object(g.jsx)(v.a,{to:"/"})}}),Object(g.jsx)(v.b,{exact:!0,path:"/otheruser/:id",render:function(t){return e.state.user?Object(g.jsx)(B,Object(i.a)({},t)):Object(g.jsx)(v.a,{to:"/"})}}),Object(g.jsx)(v.b,{exact:!0,path:"/creatpost",render:function(t){return e.state.user?Object(g.jsx)(_,Object(i.a)({},t)):Object(g.jsx)(v.a,{to:"/"})}})]})]})}}]),s}(n.Component),R=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,66)).then((function(t){var s=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;s(e),n(e),a(e),c(e),r(e)}))};p.a.get("/api/auth/loggedin").then((function(e){var t=e.data;r.a.render(Object(g.jsx)(y.a,{children:Object(g.jsx)(F,{user:t})}),document.getElementById("root"))})).catch((function(e){console.log(e)})),R()}},[[65,1,2]]]);
//# sourceMappingURL=main.9f7660b0.chunk.js.map